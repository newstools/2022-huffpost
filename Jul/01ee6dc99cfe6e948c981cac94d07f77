ALBANY, N.Y. (AP) — New York lawmakers approved a sweeping overhaul Friday of the state’s handgun licensing rules, seeking to preserve some limits on firearms after the Supreme Court ruled that most people have a right to carry a handgun for personal protection. The measure, signed by Gov. Kathy Hochul after passing both chambers by wide margins, is almost sure to draw more legal challenges from gun rights advocates who say the state is still putting too many restrictions on who can get guns and where they can carry them. Hochul, a Democrat, called the Democrat-controlled Legislature back to Albany to work on the law after last week’s high-court ruling overturning the state’s longstanding licensing restrictions. Backers said the law, which takes effect Sept. 1, strikes the right balance between complying with the Supreme Court’s ruling and keeping weapons out of the hands of people likely to use them recklessly or with criminal intent. But some Republican lawmakers, opposed to tighter restrictions, argued the law violated the constitutional right to bear arms. They predicted it too would end up being overturned. Among other things, the state’s new rules will require people applying for a handgun license to turn over a list of their social media accounts so officials could verify their “character and conduct.” Applicants will have to show they have “the essential character, temperament and judgment necessary to be entrusted with a weapon and to use it only in a manner that does not endanger oneself and others.” As part of that assessment, applicants have to turn over a list of social media accounts they’ve maintained in the past three years. “Sometimes, they’re telegraphing their intent to cause harm to others,” Gov. Kathy Hochul, a Democrat, said at a news conference. Gun rights advocates and Republican leaders were incensed, saying the legislation not only violated the Second Amendment, but also privacy and free speech rights. “New Yorkers’ constitutional freedoms were just trampled on,” state Republican Chair Nick Langworthy said. The bill approved by lawmakers doesn’t specify whether applicants will be required to provide licensing officers with access to private social media accounts not visible to the general public. People applying for a license to carry a handgun will also have to provide four character references, take 16 hours of firearms safety training plus two hours of practice at a range, undergo periodic background checks and turn over contact information for their spouse, domestic partner or any other adults living in their household. Hochul’s chief lawyer, Elizabeth Fine, insisted the state was setting out “a very clear set of eligibility criteria” and noted that the legislation includes an appeals process. The measure signed into law Friday also fixes a recently passed law that barred sales of some types of bullet-resistant vests to the general public. The previous law inadvertently left out many types of body armor, including the type worn by a gunman who killed 10 Black people in a racist attack on a Buffalo supermarket. The Supreme Court’s ruling last week struck down a 109-year-old state law that required people to demonstrate an unusual threat to their safety to qualify for a license to carry a handgun outside their homes. That restriction generally limited the licenses to people who had worked in law enforcement or had another special need that went beyond routine public safety concerns. Under the new system, the state won’t authorize permits for people with criminal convictions within the past five years for driving while intoxicated, menacing or third-degree assault. People also won’t be allowed to carry firearms at a long list of “sensitive places,” including New York City’s tourist-packed Times Square. That list also includes schools, universities, government buildings, places where people have gathered for public protests, health care facilities, places of worship, libraries, public playgrounds and parks, day care centers, summer camps, addiction and mental health centers, shelters, public transit, bars, theaters, stadiums, museums, polling places and casinos. New York will also bar people from bringing guns into any business or workplace unless the owners put up signs saying guns are welcome. People who bring guns into places without such signs could be prosecuted on felony charges. That’s a reverse approach from many other states where businesses that want to keep guns out are usually required to post signs indicating weapons aren’t allowed. Gun advocates said the law infringes on rights upheld by the Supreme Court. “Now we’re going to let the pizzeria owner decide whether or not I can express my constitutional right,” said Sen. Andrew Lanza, a Staten Island Republican. “This is a disgrace. See you in the courts.” ___ Associated Press/Report for America writer Maysoon Khan contributed to this report. Maysoon Khan is a corps member for the Associated Press/Report for America Statehouse News Initiative. Report for America is a nonprofit national service program that places journalists in local newsrooms to report on under-covered issues. Follow Maysoon Khan on Twitter.